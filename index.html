<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç¾å ´æ—¥æœ¬èª éŸ³å£°ã‚¯ã‚¤ã‚ºâ‘¡</title>

<style>
#audio {
  margin: 30px auto 160px auto;
}

#choices {
  margin-top: 30px;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  text-align: center;
  padding: 20px;
}

#counter {
  margin-bottom: 10px;
}

audio {
  display: block;
  margin: 16px auto;
}

#choices {
  margin-top: 10px;
}

button.choice {
  min-width: 220px;
  max-width: 90%;
  padding: 14px 18px;
  margin: 10px auto;
  font-size: 20px;
  border-radius: 14px;
  border: 1px solid #ccc;
  background: #f0f0f0;
  display: block;
  color: #000;
}

.hiragana {
  display: block;
  margin-top: 6px;
  font-size: 20px;
}

#nextBtn {
  margin: 24px auto 0;
  padding: 12px 22px;
  font-size: 18px;
  border-radius: 12px;
  border: 1px solid #aaa;
  background: #fff;
  display: none;
}
</style>
</head>

<body>

<h2>ğŸ§ éŸ³ã‚’èã„ã¦ãˆã‚‰ã‚“ã§ã­</h2>
<p id="counter"></p>

<audio id="audio" controls></audio>

<div id="choices"></div>

<button id="nextBtn" onclick="nextQuestion()">æ¬¡ã®å•é¡Œ â–¶ï¸</button>

<script>
const data = [
  { audio:"mite.m4a", text:"áŸá¼á˜â€‹á˜á¾á›â€‹á•á„", hira:"ã¿ã¦" },
  { audio:"kiite.m4a", text:"áŸá¼á˜â€‹áŸáŸ’áá¶á”áŸ‹â€‹á•á„", hira:"ãã„ã¦" },
  { audio:"hanashite.m4a", text:"áŸá¼á˜â€‹á“á·á™á¶á™â€‹á•á„", hira:"ã¯ãªã—ã¦" },
  { audio:"yonde.m4a", text:"áŸá¼á˜â€‹á¢á¶á“â€‹á•á„", hira:"ã‚ˆã‚“ã§" },
  { audio:"matte.m4a", text:"áŸá¼á˜â€‹ášá„áŸ‹á…á¶áŸ†â€‹á•á„", hira:"ã¾ã£ã¦" },
  { audio:"tsukatte.m4a", text:"áŸá¼á˜â€‹á”áŸ’ášá¾â€‹á•á„", hira:"ã¤ã‹ã£ã¦" },
  { audio:"wakatte.m4a", text:"áŸá¼á˜â€‹á™á›áŸ‹â€‹á•á„", hira:"ã‚ã‹ã£ã¦" },
  { audio:"oboete.m4a", text:"áŸá¼á˜â€‹á…á¶áŸ†â€‹á•á„", hira:"ãŠã¼ãˆã¦" },
  { audio:"tsutaete.m4a", text:"áŸá¼á˜â€‹á”áŸ’ášá¶á”áŸ‹â€‹á•á„", hira:"ã¤ãŸãˆã¦" },
  { audio:"tetsudatte.m4a", text:"áŸá¼á˜â€‹á‡á½á™â€‹á•á„", hira:"ã¦ã¤ã ã£ã¦" },
  { audio:"abunai.m4a", text:"á‚áŸ’ášáŸ„áŸ‡ááŸ’á“á¶á€áŸ‹! / á”áŸ’ášá™áŸááŸ’á“!", hira:"ã‚ã¶ãªã„" },
  { audio:"dame.m4a", text:"á˜á·á“á”á¶á“! / á€á»áŸ†!", hira:"ã ã‚" },
  { audio:"tomatte.m4a", text:"áˆá”áŸ‹!", hira:"ã¨ã¾ã£ã¦" }
];

const totalQuestions = 20;
let currentQuestion = 0;
let correctCount = 0;
let correctItem = null;
let answered = false;

const audio = document.getElementById("audio");
const choicesDiv = document.getElementById("choices");
const counter = document.getElementById("counter");
const nextBtn = document.getElementById("nextBtn");

function shuffle(arr) {
  return [...arr].sort(() => Math.random() - 0.5);
}

function loadQuestion() {
  answered = false;
  choicesDiv.innerHTML = "";
  nextBtn.style.display = "none";

  counter.textContent = `å•é¡Œ ${currentQuestion + 1} / ${totalQuestions}`;

  correctItem = data[Math.floor(Math.random() * data.length)];
  audio.src = correctItem.audio;
  audio.load();

  const wrongs = shuffle(
    data.filter(d => d.text !== correctItem.text)
  ).slice(0, 2);

  const options = shuffle([correctItem, ...wrongs]);

  options.forEach(opt => {
    const btn = document.createElement("button");
    btn.className = "choice";
    btn.textContent = opt.text;
    btn.onclick = () => checkAnswer(opt, btn);
    choicesDiv.appendChild(btn);
  });
}

function checkAnswer(selected, btn) {
  if (answered) return;
  answered = true;

  const buttons = document.querySelectorAll(".choice");

  buttons.forEach(b => {
    const item = data.find(d => d.text === b.textContent);

    if (item.text === correctItem.text) {
      b.innerHTML =
        "â­•ï¸ " + item.text +
        `<span class="hiragana">${item.hira}</span>`;
    } else {
      b.textContent = "âœ–ï¸ " + b.textContent;
    }
  });

  if (selected.text === correctItem.text) {
    correctCount++;
  }

  nextBtn.style.display = "block";
}

function nextQuestion() {
  currentQuestion++;
  if (currentQuestion >= totalQuestions) {
    document.body.innerHTML = `
      <h2>ğŸ‰ ãŠã¤ã‹ã‚Œã•ã¾ï¼</h2>
      <p style="font-size:22px;">
        ${totalQuestions}å•ä¸­ <strong>${correctCount}</strong> å• æ­£è§£ï¼
      </p>
    `;
  } else {
    loadQuestion();
  }
}

loadQuestion();
</script>

</body>
</html>