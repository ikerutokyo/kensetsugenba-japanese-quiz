<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç¾å ´æ—¥æœ¬èª éŸ³å£°ã‚¯ã‚¤ã‚ºâ‘¢</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  text-align: center;
  padding: 20px;
}

h2 {
  margin-bottom: 10px;
}

#counter {
  margin-bottom: 10px;
  font-size: 14px;
  color: #555;
}

/* â–¶ï¸ å†ç”Ÿãƒœã‚¿ãƒ³ï¼ˆã¦å½¢â‘ ã¨åŒã˜ï¼‰ */
#playBtn {
  margin: 20px auto 15px;
  min-width: 220px;
  max-width: 90%;
  padding: 16px 18px;
  font-size: 28px;
  border-radius: 12px;
  border: 1px solid #333;
  background: #fff;
  display: block;
}

/* é¸æŠè‚¢ */
#choices button {
  min-width: 220px;
  max-width: 90%;
  padding: 14px 18px;
  margin: 10px auto;
  font-size: 20px;
  border-radius: 12px;
  border: 1px solid #ccc;
  background: #f0f0f0;
  display: block;
  color: #000;
}

.hiragana {
  display: block;
  margin-top: 6px;
  font-size: 20px;
}

#nextBtn {
  margin: 20px auto 0;
  padding: 14px 20px;
  font-size: 18px;
  border-radius: 12px;
  display: none;
}
</style>
</head>

<body>

<h2>ğŸ§ éŸ³ã‚’èã„ã¦ãˆã‚‰ã‚“ã§ã­</h2>
<p id="counter"></p>

<button id="playBtn">â–¶ï¸</button>
<audio id="audio" preload="auto"></audio>

<div id="choices"></div>

<button id="nextBtn" onclick="nextQuestion()">æ¬¡ã®å•é¡Œ â–¶ï¸</button>

<script>
const data = [
  { audio:"haite.m4a",     text:"áŸá¼á˜â€‹á–á¶á€áŸ‹â€‹á•á„",     hira:"ã¯ã„ã¦" },
  { audio:"nuide.m4a",     text:"áŸá¼á˜â€‹áŠáŸ„áŸ‡â€‹á•á„",     hira:"ã¬ã„ã§" },
  { audio:"kabutte.m4a",   text:"áŸá¼á˜â€‹á–á¶á€áŸ‹â€‹á•à¸‡",     hira:"ã‹ã¶ã£ã¦" },
  { audio:"modotte.m4a",   text:"áŸá¼á˜â€‹ááŸ’ášá¡á”áŸ‹â€‹á•á„",  hira:"ã‚‚ã©ã£ã¦" },
  { audio:"hakonde.m4a",   text:"áŸá¼á˜â€‹áŠá¹á€â€‹á•á„",     hira:"ã¯ã“ã‚“ã§" },
  { audio:"narabete.m4a",  text:"áŸá¼á˜â€‹áá˜áŸ’ášáŸ€á”â€‹á•á„",  hira:"ãªã‚‰ã¹ã¦" },
  { audio:"atsumete.m4a",  text:"áŸá¼á˜â€‹á”áŸ’ášá˜á¼á›â€‹á•á„",  hira:"ã‚ã¤ã‚ã¦" },
  { audio:"ugokashite.m4a",text:"áŸá¼á˜â€‹á•áŸ’á›á¶áŸáŸ‹á‘á¸â€‹á•á„",hira:"ã†ã”ã‹ã—ã¦" },
  { audio:"tomete.m4a",    text:"áŸá¼á˜â€‹á”á‰áŸ’áˆá”áŸ‹â€‹á•á„",  hira:"ã¨ã‚ã¦" },
  { audio:"akete.m4a",     text:"áŸá¼á˜â€‹á”á¾á€â€‹á•á„",     hira:"ã‚ã‘ã¦" }
];

const totalQuestions = 20;
let currentQuestion = 0;
let correctCount = 0;
let correctItem = null;
let answered = false;

const audio = document.getElementById("audio");
const playBtn = document.getElementById("playBtn");
const choicesDiv = document.getElementById("choices");
const counter = document.getElementById("counter");
const nextBtn = document.getElementById("nextBtn");

playBtn.onclick = () => {
  audio.currentTime = 0;
  audio.play();
};

function shuffle(arr) {
  return [...arr].sort(() => Math.random() - 0.5);
}

function loadQuestion() {
  answered = false;
  choicesDiv.innerHTML = "";
  nextBtn.style.display = "none";

  counter.textContent = `å•é¡Œ ${currentQuestion + 1} / ${totalQuestions}`;

  correctItem = data[Math.floor(Math.random() * data.length)];
  audio.src = correctItem.audio;
  audio.load();

  const wrongs = shuffle(
    data.filter(d => d.audio !== correctItem.audio)
  ).slice(0, 2);

  const options = shuffle([correctItem, ...wrongs]);

  options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt.text;
    btn.dataset.audio = opt.audio;
    btn.onclick = () => checkAnswer(opt);
    choicesDiv.appendChild(btn);
  });
}

function checkAnswer(selected) {
  if (answered) return;
  answered = true;

  const buttons = document.querySelectorAll("#choices button");

  buttons.forEach(b => {
    const item = data.find(d => d.audio === b.dataset.audio);
    if (item.audio === correctItem.audio) {
      b.innerHTML =
        "â­•ï¸ " + item.text +
        `<span class="hiragana">${item.hira}</span>`;
    } else {
      b.textContent = "âœ–ï¸ " + b.textContent;
    }
  });

  if (selected.audio === correctItem.audio) {
    correctCount++;
  }

  nextBtn.style.display = "block";
}

function nextQuestion() {
  currentQuestion++;
  if (currentQuestion >= totalQuestions) {
    document.body.innerHTML = `
      <h2>ğŸ‰ ãŠã¤ã‹ã‚Œã•ã¾ï¼</h2>
      <p style="font-size:22px;">
        ${totalQuestions}å•ä¸­ <strong>${correctCount}</strong> å• æ­£è§£ï¼
      </p>
    `;
  } else {
    loadQuestion();
  }
}

loadQuestion();
</script>

</body>
</html>